(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,a){e.exports=a(34)},24:function(e,t,a){},25:function(e,t,a){},26:function(e,t,a){},29:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(14),r=a.n(c),l=a(8),s=(a(24),a(25),a(3)),i=a(36),u=(a(26),a(17)),m=a(15);const d="/images/colorkit.svg";var g=function(e){let{authenticated:t}=e;const a=Object(s.o)();return Object(n.useEffect)(()=>{t&&a("/dashboard")},[t,a]),o.a.createElement("div",{className:"login-container d-flex justify-content-center align-items-center",style:{backgroundImage:'url("/images/login-bg.png")',backgroundSize:"cover",height:"100vh"}},o.a.createElement("div",{className:"login-window p-4 shadow-lg rounded bg-dark text-light col-12 col-md-6 col-lg-4"},o.a.createElement("img",{id:"login-logo",src:d,alt:"Konekt logo"}),o.a.createElement("h1",null,"Konekt"),o.a.createElement("h2",null,"Welcome back!"),o.a.createElement("hr",null),o.a.createElement("p",null,"Continue with"),o.a.createElement("div",{className:"logos"},o.a.createElement("div",{className:"logo",onClick:()=>{window.location.href="https://konekt-forum-app.onrender.com/auth/discord"}},o.a.createElement(u.a,{icon:m.a,size:"2x",color:"#191b1b"})))))},h=a(16);a(29);var p=e=>{let{authenticated:t,user:a}=e;const[c,r]=Object(n.useState)([]),[l,s]=Object(n.useState)([]),[i,u]=Object(n.useState)(""),m=Object(n.useRef)(null);Object(n.useEffect)(()=>{if(t&&a){const e=document.cookie.replace(/(?:(?:^|.*;\s*)token\s*=([^;]*).*$)|^.*$/,"$1");return m.current=Object(h.a)("https://konekt-forum-app.onrender.com",{withCredentials:!0,extraHeaders:{Authorization:`Bearer ${e}`}}),m.current.on("connect",()=>{console.log("Connected to the Socket.IO server")}),m.current.on("connect_error",e=>{console.error("Connection error:",e)}),m.current.on("message",e=>{console.log("Received a message from the server:",e),s(t=>[...t,e])}),m.current.on("userConnected",e=>{console.log("User connected:",e),s(t=>[...t,{system:!0,text:e}])}),m.current.on("userDisconnected",e=>{console.log("User disconnected:",e),s(t=>[...t,{system:!0,text:e}])}),m.current.on("usersUpdate",e=>{console.log("Received updated user list:",e),r(e)}),()=>{console.log("Disconnecting from the Socket.IO server..."),m.current.disconnect()}}},[t,a]);return t&&a?o.a.createElement("div",{className:"dashboard container-fluid"},o.a.createElement("div",{className:"row no-gutters"},o.a.createElement("div",{className:"col-md-9 d-flex flex-column"},o.a.createElement("div",{className:"chatbox flex-grow-1 overflow-auto p-3"},o.a.createElement("div",{className:"messages p-3"},l.map((e,t)=>o.a.createElement("div",{key:t},e.system?o.a.createElement("em",{style:{color:"gray"}},e.text):o.a.createElement("strong",null,o.a.createElement("img",{className:"chat-pfp",src:`https://cdn.discordapp.com/avatars/${e.user.discordId}/${e.user.avatar}.png`,alt:"User Avatar",style:{width:"35px",borderRadius:"50%"}}),o.a.createElement("span",{style:{color:"aliceblue"}},e.user.username,":")," ",e.text)))))),o.a.createElement("div",{className:"logout-btn"},o.a.createElement("button",{onClick:async()=>{try{console.log("Logging out..."),await fetch("http://localhost:3000/auth/logout",{method:"GET",credentials:"include"}),console.log("Logout successful. Redirecting to login page."),window.location.href="/"}catch(e){console.error("Error logging out:",e)}}},"Logout")),o.a.createElement("div",{className:"users-display"},o.a.createElement("h2",null,"Connected Users:"),o.a.createElement("ul",null,c.map((e,t)=>o.a.createElement("p",{key:t,style:{color:"aliceblue"}},e.username)))),o.a.createElement("div",{className:"input-container col-md-3 d-flex"},o.a.createElement("div",{className:"p-3 d-flex flex-column justify-content-center flex-grow-1"},o.a.createElement("form",{className:"text-form",onSubmit:e=>{if(e.preventDefault(),i.trim())if(t)if(m.current)try{console.log("Sending message:",i.trim()),m.current.emit("message",{text:i.trim()}),u("")}catch(a){console.error("Error sending message:",a)}else console.error("Socket connection is not established. Cannot send message.");else console.error("User is not authenticated. Cannot send message.");else console.warn("Message input is empty. Please enter a message.")}},o.a.createElement("input",{type:"text",className:"form-control mb-2",placeholder:"Enter Message",value:i,onChange:e=>u(e.target.value)}),o.a.createElement("button",{className:"send-btn btn btn-primary w-100",type:"submit"},"Send")))))):o.a.createElement("p",null,"Please log in to access the dashboard.")};var E=()=>{const[e,t]=Object(n.useState)(!1),[a,c]=Object(n.useState)(null),r=Object(s.o)();return Object(n.useEffect)(()=>{(async()=>{try{const a=await i.a.get("https://konekt-forum-app.onrender.com/auth/status",{withCredentials:!0});200===a.status&&a.data.authenticated?(t(!0),c(a.data.user),r("/dashboard")):(t(!1),c(null),r("/"))}catch(e){t(!1),c(null),r("/")}})()},[r]),o.a.createElement("div",null,o.a.createElement(s.c,null,o.a.createElement(s.a,{path:"/",element:o.a.createElement(g,{authenticated:e})}),o.a.createElement(s.a,{path:"/dashboard",element:o.a.createElement(p,{authenticated:e,user:a})})))};r.a.createRoot(document.getElementById("root")).render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(l.a,null,o.a.createElement(E,null))))}},[[18,1,2]]]);
//# sourceMappingURL=main.d0649baa.chunk.js.map